<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Manage Drivers</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link href="styleSheet.css">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">


</head>
<body>


<div class="d-flex justify-content-md-evenly p-5">
    <button class="btn btn-success" data-bs-target="#exampleModal" data-bs-toggle="modal" type="button"
            id="DriverManager">
        Add Driver
    </button>




</div>

<form class="col-2 " id="DriverForms">
    <div aria-hidden="true"  aria-labelledby="exampleModalLabel" class="modal fade modal fade bd-example-modal-lg" id="exampleModal" tabindex="-1"
         id="Driverform">
        <div class="modal-dialog position-absolute" style="margin-left: 38rem;">
            <div class="modal-content" style="width: max-content">
                <div class="modal-header" style="background-color: #2c3e50;">
                    <h5 class="modal-title" style="color: white" id="exampleModalLabel1">Add Driver </h5>
                    <button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
                </div>

                <!--save car-->
                <div class="tab-content " id="pills-tabContent">
                    <div class="tab-pane fade show active" id="pills-home" role="tabpanel"
                         aria-labelledby="pills-home-tab"
                         tabindex="0">
                        <section class="vh-140" style="background-color:slategray">
                            <div class="container h-100">
                                <div class="row d-flex justify-content-center align-items-center h-100 p-4">
                                    <div class="col-xl-9">

                                        <div class="card" style="border-radius: 15px;">
                                            <div class="card-body">

                                                <div class="row align-items-center pt-4 pb-3">
                                                    <div class="col-md-3 ps-5">

                                                        <h6 class="mb-0">License ID</h6>

                                                    </div>
                                                    <div class="col-md-9 pe-3">

                                                        <input class="form-control" id="txtDriverLicense" type="text" name="license" placeholder="license" style="border-color: darkslateblue" >
                                                        <br><button type="button" class="btn btn-dark"  type="button" id="searchDriver">search</button>

                                                    </div>
                                                </div>

                                                <hr class="mx-n3">

                                                <div class="row align-items-center pt-4 pb-3">
                                                    <div class="col-md-3 ps-5">

                                                        <h6 class="mb-0">Name</h6>

                                                    </div>
                                                    <div class="col-md-9 pe-5">

                                                        <input class="form-control" id="txtDriverName" type="text" name="name" placeholder="Name" style="border-color: darkslateblue" >

                                                    </div>
                                                </div>

                                                <hr class="mx-n3">

                                                <div class="row align-items-center pt-4 pb-3">
                                                    <div class="col-md-3 ps-5">

                                                        <h6 class="mb-0">Address</h6>

                                                    </div>
                                                    <div class="col-md-9 pe-5">

                                                        <input class="form-control" id="txtDriverAddress" type="text" name="address" placeholder="Address" style="border-color: darkslateblue" >

                                                    </div>
                                                </div>

                                                <hr class="mx-n3">

                                                <div class="row align-items-center py-3">
                                                    <div class="col-md-3 ps-5">

                                                        <h6 class="mb-0"></h6>

                                                    </div>
                                                    <div class="col-md-9 pe-5">

                                                        <div class="d-flex justify-content-between">
                                                            <div>
                                                                <img src="#" class="img-thumbnail" alt="...">
                                                                <div class="mb-3">
                                                                    <label for="formFileSm1" class="form-label">Small
                                                                        file
                                                                        input
                                                                        example</label>
                                                                    <input class="form-control form-control-sm"
                                                                           id="formFileSm1"
                                                                           type="file">
                                                                </div>
                                                            </div>

                                                            <div>
                                                                <img src="#" class="img-thumbnail" alt="...">
                                                                <div class="mb-3">
                                                                    <label for="formFileSm2" class="form-label">Small
                                                                        file
                                                                        input
                                                                        example</label>
                                                                    <input class="form-control form-control-sm"
                                                                           id="formFileSm2"
                                                                           type="file">
                                                                </div>
                                                            </div>
                                                        </div>

                                                    </div>
                                                </div>

                                                <hr class="mx-n3">

                                                <div class="row align-items-center pt-4 pb-3">
                                                    <div class="col-md-3 ps-5">

                                                        <h6 class="mb-0">Contact No</h6>

                                                    </div>
                                                    <div class="col-md-9 pe-5">

                                                        <input class="form-control" id="txtDriverContact" type="text" name="contact" placeholder="Contact" style="border-color: darkslateblue" >

                                                    </div>
                                                </div>

                                                <hr class="mx-n3">

                                                <div class="row align-items-center pt-4 pb-3">
                                                    <div class="col-md-3 ps-5">

                                                        <h6 class="mb-0">Available</h6>

                                                    </div>
                                                    <div class="col-md-9 pe-5">

                                                        <select class="form-select" aria-label="Transmission" id="ddSelect" onchange="ddISelect();">
                                                            <option value="Yes">Yes</option>
                                                            <option value="No">No</option>
                                                        </select>
                                                        <br>
                                                        <input type="text" readonly="readonly" style="border-color: darkslateblue" name="available" id="txtDriverAvailable" >
                                                    </div>
                                                </div>

                                                <hr class="mx-n3">

                                                <div class="px-5 py-4">
                                                    <button type="button" class="btn btn-primary" type="button" id="saveDriver">Register Driver</button>

                                                </div>

                                                <div class="px-5 py-4">
<!--                                                    <button class="btn btn-dark"  type="button" id="searchDriver">search</button>-->
                                                    <button class="btn btn-dark"  type="button" id="updateDriver">Update</button>
                                                    <button class="btn btn-dark"  type="button" id="DeleteDriver">Delete</button>

                                                </div>

                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </section>

                    </div>
                </div>

            </div>
        </div>
    </div>
</form>

<div class="table"  >
    <table class="table">
        <thead>
        <tr>
            <th scope="col">License</th>
            <th scope="col">Name</th>
            <th scope="col">Address</th>
            <th scope="col">Contact</th>
            <th scope="col">Available</th>


        </tr>
        </thead>
        <tbody class="Drivertable">
        <tr>
        </tr>
        <tr>
        </tr>
        <tr>
        </tr>
        </tbody>
    </table>
</div>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>


<script>
    let baseUrl = "http://localhost:8080/Car_Rental_System_war/"
    LoadAllDriver();

    //Driver save

    $("#saveDriver").click(function (){
        alert('weda')
        let formData = $("#DriverForms").serialize()
        $.ajax({
            url:baseUrl+"driver",
            method:"post",
            dataType:"json",
            data:formData,
            success:function (res){
                alert("save data");
                LoadAllDriver();
            }
        })
    });

    // $("#searchDriver").click(function (){
    //     alert('elama')
    //     $.ajax({
    //         url:baseUrl+"driver?license=" + $("#txtDriverLicense").val(),
    //         dataType:"json",
    //         method: "get",
    //         success:function (res){
    //             $("#txtDriverName").val(res.data.name)
    //             $("#txtDriverAddress").val(res.data.address)
    //             $("#txtDriverContact").val(res.data.contact)
    //             $("#txtDriverAvailable").val(res.data.available)
    //         }
    //     })
    // });

    //Driver Search

    $("#searchDriver").click(function (){
        $.ajax({
            url:baseUrl+"driver?license=" + $("#txtDriverLicense").val(),
            dataType:"json",
            method:"get",
            async:false,
            success:function (res){
                console.log(res)
                $('#txtDriverLicense').val(res.data.license);
                $('#txtDriverName').val(res.data.name);
                $('#txtDriverAddress').val(res.data.address);
                $('#txtDriverContact').val(res.data.contact);
                $('#txtDriverAvailable').val(res.data.available);
            },
            error:function (error){

            }
        })
    });

    //Delete Car
    $('#DeleteDriver').click(function (){
        alert($("#txtDriverLicense").val())
        $.ajax({
            url:baseUrl+"driver?license=" + $("#txtDriverLicense").val(),
            dataType: "json",
            method:"delete",
            success:function (res){
                alert(res.message);
                LoadAllDriver();
            },
            error:function (error){

            }
        })
    });


    //load Drivers
    function LoadAllDriver(){
        $.ajax({
            url:baseUrl+"driver",
            success:function (res){
                $('.Drivertable').empty();
                for(let i=0;i<res.data.length;i++){
                    $('.Drivertable').append(`<tr><td>`+res.data[i].license +`</td><td>`+res.data[i].name+`</td><td>`+res.data[i].address+`</td><td>`+res.data[i].contact+`</td><td>`+res.data[i].available+`</td></tr>`)
                }
            }
        })
    };

    //Update Drivers
    $('#updateDriver').click(function (){
        let driverJson={
            license:$('#txtDriverLicense').val(),
            name:$('#txtDriverName').val(),
            address:$('#txtDriverAddress').val(),
            contact:$('#txtDriverContact').val(),
            available:$('#txtDriverAvailable').val()
        };
        $.ajax({
            url:baseUrl+"driver",
            method:"put",
            data:JSON.stringify(driverJson),
            dataType:"jason",
            contentType:"application/json",
            async:false,
            success:function (res){
                alert(res.message);
                LoadAllDriver();
            },
            error: function (error){
                alert(JSON.parse(error.responseText).message)
            }
        })
    });

    $('#ddSelect').click(function (){
        let vl = $('#ddSelect').val()

        $('#txtDriverAvailable').val(vl)
    });





</script>

<!--<script type="text/javascript" src="jquery-3.6.1.min.js"></script>-->

<!--<script>-->
<!--    function ddISelect(){-->
<!--        var d = document.getElementById("ddSelect")-->
<!--        var display = d.options[d.selectedIndex].text;-->
<!--        document.getElementById("txtDriverAvailable").value = display;-->
<!--    }-->
<!--</script>-->


</body>
</html>