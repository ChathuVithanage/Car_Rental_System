<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Customer Register</title>
  <link href="styleSheet.css">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
  <link href="index.css" rel="stylesheet">
  <style>
    #customer_Registration{
      background-image: url("assest/lukas-blazek-EWDvHNNfUmQ-unsplash.jpg");
      width: 1536px;
      height: 712px;
      background-size: cover;
      background-repeat: no-repeat;
      opacity: 90%;
    }

    .table{
      position: absolute;
      width: 70%;
      top: 60%;
      left: 29%;
    }


    .nav-link h5:hover{
      color: firebrick;
    }

  </style>
</head>
<body>

<header class="sticky-top">
  <nav class="navbar navbar-expand-lg bg-body-tertiary " style="background-color: #2c3945; height: 55px; ">
    <img src="assest/classic-car.png" class="logo" style="width: 90px">
    <label style="width: 96px"><h5 style="color: yellow; text-shadow: 1px 1px 2px wheat, 0 0 25px white, 0 0 5px white;">Car Vista</h5></label>

    <div class="container-fluid">
      <a class="navbar-brand" href="#"></a>

      <div class="nav justify-content-end" id="navbarNavAltMarkup">
        <div class="navbar-nav">
          <a class="nav-link active fw-bold" aria-current="page" href="index.html" style=" padding-left: 18px; padding-right: 25px; color: white"><h5>Home</h5></a>
          <a class="nav-link fw-bold" href="" style=" padding-left: 18px; padding-right: 25px; color: white"><h5>Car</h5></a>
          <a class="nav-link fw-bold" href="index.html#aboutUs" style="padding-left: 18px; padding-right: 25px; color: white"><h5>About Us</h5></a>

        </div>
      </div>

    </div>
  </nav>
</header>

<section id="customer_Registration"  >
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header" style="padding-left: 15%">
        <h5 class="modal-title" id="exampleModalLabel1" style="font-size: 30px; left: 35px; padding-top: 58px">Customer Registration</h5>
      </div>


      <form id="CusRegister">
      <div class="modal-body">

        <section style="width: 630px; padding-left: 110px; padding-top: 50px;" >
          <div class="mb-3" style="stroke: black">
            <input class="form-control" id="txtCustomerId" type="text" name="nic" placeholder="Nic" style="border-color: darkslateblue" >
          </div>
          <div class="mb-3">
            <input class="form-control" id="txtCustomerName" multiple type="text" name="name" placeholder="Name" style="border-color: darkslateblue">
          </div>
          <div class="mb-3">
            <input class="form-control" id="txtCustomerAddress" type="text" name="address" placeholder="Address" style="border-color: darkslateblue">
          </div>
          <div class="mb-3">
            <input class="form-control form-control-sm" id="txtCustomerPassword" type="text" name="password" placeholder="Password" style="border-color: darkslateblue">
          </div>
          <div class="mb-3">
            <input class="form-control form-control-sm" id="txtCustomerContactNum" type="number" name="Contact" placeholder="ContactNum" style="border-color: darkslateblue">
          </div>
          <div class="mb-3">
            <input class="form-control form-control-sm" id="txtCustomerLicence" type="text" name="license" placeholder="Licence" style="border-color: darkslateblue">
          </div>
          <div class="mb-3">
            <input class="form-control" type="file" id="formFiles23" placeholder="Please insert nic picture " style="border-color: darkslateblue">
          </div>
          <div aria-label="Basic mixed styles example" class="btn-group" role="group">
            <button class="btn btn-danger" type="button" id="CustomerDelete"  > Delete</button>
            <button class="btn btn-warning" type="button" id="CustomerUpdate"  > Update</button>
            <button class="btn btn-success " type="button" id="clearDetails" > Clear</button>
            <button class="btn btn-info " type="button" id="searchCustomer"  >search </button>
          </div>
        </section>
      </div>
      </form>


      <div style="padding-top: 26px; padding-left: 450px;">
        <!--                <button class="btn btn-secondary" type="button">Close</button>-->
        <button class="btn btn-primary" type="button" id="saveCustomer">Register Customer</button>
      </div>

      <div class="table"  >
      <table class="table">
        <thead>
        <tr>
          <th scope="col">NIC</th>
          <th scope="col">License</th>
          <th scope="col">Name</th>
          <th scope="col">Address</th>
          <th scope="col">Contact</th>

        </tr>
        </thead>
        <tbody class="Customertable">
        <tr>
        </tr>
        <tr>
        </tr>
        <tr>
        </tr>
        </tbody>
      </table>
      </div>


    </div>
  </div>
</section>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.6.1.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>

<script>
  let baseUrl = "http://localhost:8080/Car_Rental_System_war/"
  let baseUerlD="http://localhost:8080/Car_Rental_System_war/"
  $("#saveCustomer").click(function (){
    let formData = $("#CusRegister").serialize()
    $.ajax({
      url:baseUrl+"customer",
      method:"post",
      dataType:"json",
      data:formData,
      success:function (res){
        alert("save data");
        LoadAllCustomer();
        clearTextFields();
      }

    })
  })

  $("#searchCustomer").click(function (){

    $.ajax({
      url:baseUrl+"customer?nic=" + $("#txtCustomerId").val(),
      dataType:"json",
      method: "get",
      success:function (res){
        $("#txtCustomerName").val(res.data.name)
        $("#txtCustomerAddress").val(res.data.address)
        $("#txtCustomerPassword").val(res.data.password)
        $("#txtCustomerContactNum").val(res.data.contact)
        $("#txtCustomerLicence").val(res.data.license)
      }
    })
  });

  $('#CustomerDelete').click(function (){
   alert($("#txtCustomerId").val())
    $.ajax({
      url:baseUrl+"customer?nic=" + $("#txtCustomerId").val(),
      dataType: "json",
      method:"delete",
      success:function (res){
        alert(res.message);
        clearTextFields();
        LoadAllCustomer();
      },
      error:function (error){

      }
    })
  });
  LoadAllCustomer();

  function LoadAllCustomer(){
    $.ajax({
      url:baseUrl+"customer",
      success:function (res){
        $('.Customertable').empty();
        for(let i=0;i<res.data.length;i++){
          $('.Customertable').append(`<tr><td>`+res.data[i].nic +`</td><td>`+res.data[i].license+`</td><td>`+res.data[i].name+`</td><td>`+res.data[i].address+`</td><td>`+res.data[i].contact+`</td></tr>`)
        }
      }
    })
  };

  $('#CustomerUpdate').click(function (){
    let customerJson={
      nic:$('#txtCustomerId').val(),
      name:$('#txtCustomerName').val(),
      license:$('#txtCustomerLicence').val(),
      address:$('#txtCustomerAddress').val(),
      contact:$('#txtCustomerContactNum').val(),
      password:$('#txtCustomerPassword').val()
    };
    $.ajax({
       url:baseUrl+"customer",
      method:"put",
      data:JSON.stringify(customerJson),
      dataType:"jason",
      contentType:"application/json",
      async:false,
      success:function (){
         alert('update');
        LoadAllCustomer();
        clearTextFields();
      }
    })
  });

  function clearTextFields(){
    //$("#carAdd").find(":input")
    $("form#CusRegister :input").val('')

  }

</script>

</body>
</html>